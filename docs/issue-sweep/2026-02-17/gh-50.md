# GH-50 메모리 누수 - WebSocket 버퍼/캔들 맵 무한 성장

- URL: https://github.com/Cha-Ji/pocket-chrome-extension/issues/50
- Decision: CLOSE
- Evidence (현재 main 기준):
  - 관련 커밋/PR:
    - 9030c79: Session E refactor — connections Map 및 buffer 관리 코드 전면 제거
    - e966a22: data pipeline stabilization — stale ticker cleanup + tick observability 추가
    - 817a43c: event listener memory leak 수정 (boundHandler 패턴)
  - 관련 파일:
    - src/content-script/websocket-interceptor.ts: messageBuffer 미사용 상태, connections Map 완전 제거
    - src/content-script/candle-collector.ts: maxCandles=500 제한, maxTicksPerTicker=2000 제한, 5분 stale cleanup
  - 재현/비재현 근거:
    - 문제 1 (messageBuffer 무한 성장): messageBuffer가 코드에 남아있으나 데이터 추가 로직 제거됨 — 비재현
    - 문제 2 (candles Map 무한 성장): candles.slice(-maxCandles) FIFO 적용, stale ticker 5분 주기 정리 — 비재현
    - 문제 3 (connections Map 누수): connections Map 자체가 제거됨, Tampermonkey bridge 모델로 전환 — 비재현
- Changes in this PR:
  - docs/issue-sweep/2026-02-17/gh-50.md 감사 문서 추가
- Tests:
  - npx vitest run — 전체 테스트 통과 확인
- Follow-ups:
  - websocket-interceptor.ts의 dead code (messageBuffer 선언, getStatus()의 messageCount) 정리 검토
  - CandleCollector.getCollectorStats()로 런타임 메모리 모니터링 활용 가능
